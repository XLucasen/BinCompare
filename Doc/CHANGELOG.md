# 版本更新日志

## v1.6.1 (2025-11-22)

### 🐛 bug 修复

#### 拖拽文件加载功能修复
- **修复应用启动冲突**：移除 `StartupUri`，改为在 `Startup` 事件中手动创建主窗口
- **修复文件加载时机**：改用 `ContentRendered` 事件而不是 `Loaded` 事件，确保 ViewModel 完全初始化
- **完善文件关联**：提供 PowerShell、批处理和注册表三种文件关联注册方式

### ✨ 新增功能

#### 拖拽文件到程序图标加载
- **单文件拖拽**：拖拽一个文件到程序图标，自动加载到文件A
- **双文件拖拽**：拖拽两个文件到程序图标，自动加载到文件A和文件B，自动进行对比
- **命令行启动**：支持通过命令行参数启动程序并加载文件

#### 文件关联配置
- **PowerShell 脚本**：自动检查权限和程序路径
- **批处理脚本**：简单易用的注册脚本
- **注册表文件**：直接导入注册表配置

### 📚 文档更新
- 新增 `DRAG_DROP_FIX_SUMMARY.md` - 拖拽功能修复总结
- 新增 `FILE_LOADING_FIX.md` - 文件加载修复说明
- 新增 `FINAL_VERIFICATION.md` - 完整的测试和验证指南
- 新增 `QUICK_SETUP.md` - 快速设置指南
- 新增 `FILE_ASSOCIATION_SETUP.md` - 文件关联设置指南
- 新增 `DRAG_DROP_GUIDE.md` - 拖拽功能详细指南
- 新增 `COMMAND_LINE_REFERENCE.md` - 命令行参数参考

### 🔧 技术改进
- 改进应用启动流程，确保所有初始化完成后再处理命令行参数
- 优化 ViewModel 初始化时机
- 完善错误处理和用户提示

### 📊 编译状态
- 编译成功，0 个错误，36 个警告
- 所有功能已实现并测试

---

## v1.6.0 (2025-11-22)

### ✨ 新增功能

#### 字节级差异高亮显示
- **单字节差异显示**：只有差异的字节显示为浅红色背景 + 红色文字，其他字节保持白色背景
- **点击高亮功能**：点击右侧"差异信息"列表中的任意差异项，对应的差异字节会以黄色背景 + 黑色文字临时高亮显示
- **自动取消高亮**：高亮状态在2秒后自动取消，恢复为浅红色

### 🔧 技术改进

#### 数据模型
- `ByteSegment` 类新增 `IsHighlighted` 属性，支持临时高亮状态
- `ByteSegment` 实现 `INotifyPropertyChanged` 接口，支持属性变更通知

#### UI 渲染
- 将整行数据显示改为 `ItemsControl` + `ByteSegments` 集合
- 每个字节段单独渲染，支持独立的高亮效果
- 使用 `MultiBinding` 实现多条件转换

#### 转换器
- `ByteSegmentBackgroundConverter` 改为 `IMultiValueConverter`
- `ByteSegmentForegroundConverter` 改为 `IMultiValueConverter`
- 支持 `IsDifference` 和 `IsHighlighted` 两个绑定值

#### 交互逻辑
- 添加高亮计时器，支持自动取消高亮
- 优化点击差异列表的响应逻辑
- 支持快速切换多个差异的高亮显示

### 📊 性能优化
- 高亮操作只修改 `IsHighlighted` 属性，通过数据绑定更新 UI
- 计时器使用 2 秒延迟，自动清除高亮状态
- 支持大文件对比，每行最多 64 个字节

### 📚 文档更新
- 新增 `FEATURE_TEST.md` - 详细的功能测试指南
- 新增 `BYTE_HIGHLIGHT_GUIDE.md` - 快速参考指南
- 新增 `CHANGELOG.md` - 版本更新日志

### 🐛 已知问题
- 无

### 🔮 未来计划
- 支持自定义高亮时间和颜色
- 添加键盘快捷键快速导航差异
- 添加"上一个差异"和"下一个差异"按钮
- 支持多选差异进行批量操作

---

## v1.5.3 (2025-11-22)

### ✨ 功能完整
- 双文件对比（十六进制和二进制显示）
- 可配置行长度（8/16/32/64字节）
- 差异自动检测和高亮（整行高亮）
- 快速导航和滚动同步
- 差异导出功能
- 5个键盘快捷键

### 📊 项目统计
- 代码行数：~1200行（不含文档）
- 编译状态：成功（28个警告，0个错误）
- 测试文件：TestFileA.bin 和 TestFileB.bin

---

## 版本号说明

采用语义化版本控制 (Semantic Versioning)：
- **主版本号 (Major)**：添加不兼容的 API 变更
- **次版本号 (Minor)**：添加向后兼容的新功能
- **修订号 (Patch)**：修复向后兼容的 bug

### v1.6.0 的变更
- 次版本号增加：添加了字节级高亮功能（新功能，向后兼容）
- 修订号重置为 0

---

## 编译信息

### v1.6.0
- 框架：.NET 8.0 Windows
- 编译状态：✅ 成功
- 错误数：0
- 警告数：36（都是 null 性相关的警告）

### 构建命令
```bash
# 调试构建
dotnet build

# 发布构建
dotnet publish -c Release
```

---

## 贡献者

- **Lucas__Sen** (@枭龙网络)
  - 项目创建和主要开发
  - v1.6.0 字节级高亮功能实现

---

## 许可证

本项目为私有项目，版权归枭龙网络所有。
