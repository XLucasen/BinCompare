# 拖拽文件加载功能测试指南

## 前置条件

1. 编译成功：`dotnet build`
2. 准备测试文件：
   - `TestFileA.bin` - 测试文件A
   - `TestFileB.bin` - 测试文件B
   - 其他二进制文件（可选）

## 测试场景

### 测试 1：拖拽单个文件到程序图标

**步骤**：
1. 关闭所有 BinCompare 程序实例
2. 在文件管理器中找到 `TestFileA.bin`
3. 将文件拖拽到 BinCompare 程序图标上
4. 等待程序启动

**预期结果**：
- ✅ 程序启动
- ✅ 文件A 显示为 `TestFileA.bin`
- ✅ 文件A 的数据显示在左侧
- ✅ 文件B 为空
- ✅ 状态栏显示 "文件A已加载: TestFileA.bin (xxx 字节)"

**验证方式**：
```
检查项：
□ 程序成功启动
□ 文件A 名称正确
□ 文件A 数据正确显示
□ 文件B 为空
□ 状态消息正确
```

---

### 测试 2：拖拽两个文件到程序图标

**步骤**：
1. 关闭所有 BinCompare 程序实例
2. 在文件管理器中找到 `TestFileA.bin` 和 `TestFileB.bin`
3. 同时选中两个文件（Ctrl+点击）
4. 将两个文件拖拽到 BinCompare 程序图标上
5. 等待程序启动并进行对比

**预期结果**：
- ✅ 程序启动
- ✅ 文件A 显示为 `TestFileA.bin`
- ✅ 文件B 显示为 `TestFileB.bin`
- ✅ 两个文件的数据都显示
- ✅ 自动进行对比
- ✅ 差异信息显示在右侧
- ✅ 状态栏显示对比结果

**验证方式**：
```
检查项：
□ 程序成功启动
□ 文件A 名称正确
□ 文件B 名称正确
□ 两个文件数据都显示
□ 自动进行了对比
□ 差异信息正确显示
□ 状态消息正确
```

---

### 测试 3：通过命令行启动（单文件）

**步骤**：
1. 打开命令提示符或 PowerShell
2. 执行命令：
   ```bash
   BinCompare.exe "C:\path\to\TestFileA.bin"
   ```
3. 等待程序启动

**预期结果**：
- ✅ 程序启动
- ✅ 文件A 加载成功
- ✅ 文件B 为空

**验证方式**：
```
检查项：
□ 程序成功启动
□ 文件A 加载成功
□ 文件B 为空
```

---

### 测试 4：通过命令行启动（双文件）

**步骤**：
1. 打开命令提示符或 PowerShell
2. 执行命令：
   ```bash
   BinCompare.exe "C:\path\to\TestFileA.bin" "C:\path\to\TestFileB.bin"
   ```
3. 等待程序启动并进行对比

**预期结果**：
- ✅ 程序启动
- ✅ 文件A 加载成功
- ✅ 文件B 加载成功
- ✅ 自动进行对比
- ✅ 差异信息显示

**验证方式**：
```
检查项：
□ 程序成功启动
□ 文件A 加载成功
□ 文件B 加载成功
□ 自动进行了对比
□ 差异信息正确显示
```

---

### 测试 5：拖拽不存在的文件

**步骤**：
1. 关闭所有 BinCompare 程序实例
2. 创建一个不存在的文件路径（例如 `C:\nonexistent\file.bin`）
3. 通过命令行启动：
   ```bash
   BinCompare.exe "C:\nonexistent\file.bin"
   ```

**预期结果**：
- ✅ 程序启动
- ✅ 状态栏显示错误信息："文件不存在: C:\nonexistent\file.bin"
- ✅ 程序继续运行，可以手动加载文件

**验证方式**：
```
检查项：
□ 程序成功启动
□ 显示错误信息
□ 程序可以继续使用
```

---

### 测试 6：拖拽多个文件（3个或以上）

**步骤**：
1. 关闭所有 BinCompare 程序实例
2. 选中 3 个或更多二进制文件
3. 拖拽到程序图标

**预期结果**：
- ✅ 程序启动
- ✅ 只有前两个文件被加载
- ✅ 其他文件被忽略
- ✅ 自动进行对比

**验证方式**：
```
检查项：
□ 程序成功启动
□ 只有前两个文件被加载
□ 自动进行了对比
```

---

### 测试 7：拖拽大文件

**步骤**：
1. 准备一个较大的二进制文件（>10MB）
2. 拖拽到程序图标

**预期结果**：
- ✅ 程序启动（可能需要几秒钟）
- ✅ 文件加载成功
- ✅ 程序响应正常

**验证方式**：
```
检查项：
□ 程序成功启动
□ 文件加载成功
□ 加载时间合理（<10秒）
□ 程序响应正常
```

---

### 测试 8：拖拽不同格式的文件

**步骤**：
1. 准备不同格式的二进制文件：
   - `.bin` 文件
   - `.dat` 文件
   - `.hex` 文件
   - `.rom` 文件
   - 其他二进制格式
2. 分别拖拽到程序图标

**预期结果**：
- ✅ 所有文件都能成功加载
- ✅ 数据正确显示
- ✅ 对比功能正常

**验证方式**：
```
检查项：
□ .bin 文件加载成功
□ .dat 文件加载成功
□ .hex 文件加载成功
□ .rom 文件加载成功
□ 其他格式文件加载成功
```

---

### 测试 9：快速连续拖拽

**步骤**：
1. 快速拖拽第一个文件到程序图标
2. 程序启动后，再拖拽第二个文件到程序图标
3. 观察程序行为

**预期结果**：
- ✅ 第一个程序实例启动并加载文件
- ✅ 第二个拖拽操作启动新的程序实例
- ✅ 两个程序实例独立运行

**验证方式**：
```
检查项：
□ 第一个实例成功启动
□ 第二个实例成功启动
□ 两个实例独立运行
```

---

### 测试 10：拖拽后手动加载文件

**步骤**：
1. 拖拽一个文件到程序图标（文件A）
2. 程序启动后，手动加载第二个文件（文件B）
3. 观察对比结果

**预期结果**：
- ✅ 文件A 自动加载
- ✅ 文件B 手动加载成功
- ✅ 自动进行对比
- ✅ 差异信息正确显示

**验证方式**：
```
检查项：
□ 文件A 自动加载
□ 文件B 手动加载成功
□ 自动进行了对比
□ 差异信息正确
```

---

## 性能测试

### 测试 11：加载时间测试

**测试文件大小**：
- 小文件：< 1MB
- 中等文件：1MB - 10MB
- 大文件：> 10MB

**测试步骤**：
1. 记录拖拽时间
2. 记录程序启动时间
3. 记录文件加载完成时间
4. 计算总时间

**预期结果**：
- ✅ 小文件：< 2 秒
- ✅ 中等文件：< 5 秒
- ✅ 大文件：< 10 秒

---

## 错误处理测试

### 测试 12：权限不足

**步骤**：
1. 创建一个没有读取权限的文件
2. 拖拽到程序图标

**预期结果**：
- ✅ 程序启动
- ✅ 显示错误信息
- ✅ 程序继续运行

---

### 测试 13：文件被占用

**步骤**：
1. 用另一个程序打开一个文件
2. 拖拽该文件到程序图标

**预期结果**：
- ✅ 程序启动
- ✅ 文件加载成功（Windows 允许多个程序读取同一文件）
- ✅ 数据正确显示

---

## 完整测试清单

```
基本功能测试：
□ 测试 1：拖拽单个文件
□ 测试 2：拖拽两个文件
□ 测试 3：命令行启动（单文件）
□ 测试 4：命令行启动（双文件）

错误处理测试：
□ 测试 5：拖拽不存在的文件
□ 测试 6：拖拽多个文件
□ 测试 12：权限不足
□ 测试 13：文件被占用

兼容性测试：
□ 测试 7：拖拽大文件
□ 测试 8：拖拽不同格式文件
□ 测试 9：快速连续拖拽
□ 测试 10：拖拽后手动加载

性能测试：
□ 测试 11：加载时间测试

总体评估：
□ 所有测试通过
□ 功能正常
□ 性能满足要求
□ 错误处理完善
```

---

## 测试报告模板

```
测试日期：YYYY-MM-DD
测试人员：[名字]
测试环境：Windows [版本], .NET 8.0

测试结果：
- 通过：[数量]
- 失败：[数量]
- 跳过：[数量]

失败项目：
1. [测试名称] - [失败原因]
2. [测试名称] - [失败原因]

性能指标：
- 小文件加载时间：[时间]
- 中等文件加载时间：[时间]
- 大文件加载时间：[时间]

总体评价：
[评价内容]

建议：
[改进建议]
```

---

**版本**：v1.6.0+  
**最后更新**：2025-11-22
